# 顧客關係經營分析（Streamlit）

此專案提供一個可在 iOS/桌面瀏覽器操作的 Streamlit 網頁工具：
- 上傳「帳單紀錄」（可多檔，會員名單可選）
- 預設以「帳單歷史首次結帳」判定新客（最穩）
- 計算 60 天內未回訪的新客流失率
- 依師傅（設計師）分流失率，並可查看流失名單
- 提供 Repeat Rate（新客回訪率）
- 提供空窗率（月，168 小時上限；依項目分鐘估算）
- 內建流失率/回訪率圖表，方便快速比較
- 提供回訪時間分布圖（P50/P70/P80/P90）
- 提供師傅排行榜（Top 6 表現較佳 / 需關注）
- 分店比較圖可切換：群組直條 / 熱度圖 / 堆疊條（下方附 Small Multiples）
- 可排除師傅（側邊欄）

## 本機執行
```
python3 -m pip install -r requirements.txt
streamlit run app.py
```

## 部署到 Streamlit Community Cloud
1. 將此專案推到 GitHub
2. 到 Streamlit Cloud 建立 App，選擇 `app.py`
3. 上線後即可用網址操作（iOS 也可）

## 注意
- 帳單檔預設使用「服務 + 票券」工作表，可在側邊欄切換
- 60 天滿期的才納入流失率分母
- 若改用「會員來店次數 = 1」，需上傳會員名單
- 若帳單包含「分店」欄位，介面會提供分店篩選與分店統計
- 若帳單缺少「分店」欄位，系統會用檔名推斷分店名稱
- 空窗率：以項目中的「分鐘」文字抓時長，1～30=0.5、31～60=1、61～90=1.5 依此類推
- 圖表可設定只顯示前 N 名（側邊欄）
